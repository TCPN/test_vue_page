import{d as z,l as q,u as y,c as u,o as l,a as c,m as g,F as h,r as _,t as p,n as F,p as A,k as w,g as O,_ as S}from"./Footer-B0WzRYIo.js";function k(t,e){const s=t.questions[e];return s?s.options??t.defaultOptions??[]:[]}function C(t=null){if(!t)return null;const e=new FormData(t);return Array.from(e.entries())}function N(t,e){return!t||t.length<e.questions.length?"尚有題目未作答":null}function b(t,e){let s=0;for(let[n,r]of t??[]){const o=e.questions.find(a=>a.index===Number(n));if(o?.scores){s+=o.scores[r]??0;continue}const f=k(e,Number(n)).find(a=>a.value===r);if(f){s+=f.score??0;continue}}return s}const I=(t,e)=>b(t,e)/e.questions.length;function R(t,e){const s=b(t,e);return{score:s,text:`你的總分是 ${s} 分`}}const D={ref:"questions",class:"questions"},E={class:"question-text"},M={class:"question-options"},T=["name","value"],j={key:0,ref:"result",class:"result"},Q={key:0},V=["innerHTML"],B=["textContent"],L=z({__name:"QuizForm",props:{quiz:{}},setup(t){const e=t,s=q(null),n=q(null),r=y("quizForm"),o=y("result");function i(){const f=e.quiz.getAnswers??C,a=e.quiz.validateAnswers??N,d=e.quiz.getResult??R,m=f(r.value),v=a(m,e.quiz);if(v){s.value=v;return}s.value=null,n.value=d(m,e.quiz)??null,console.log("quizResult",m,n.value),A(()=>{o.value?.scrollIntoView({behavior:"smooth"})})}return(f,a)=>(l(),u(h,null,[c("form",{ref_key:"quizForm",ref:r,class:"no-select"},[c("ol",D,[(l(!0),u(h,null,_(t.quiz.questions,(d,m)=>(l(),u("li",{key:m,class:"question"},[c("div",E,p(d.text),1),c("div",M,[(l(!0),u(h,null,_(w(k)(t.quiz,m),(v,x)=>(l(),u("label",{key:x,class:"question-option"},[c("input",{type:"radio",name:`${d.index}`,value:v.value},null,8,T),O(" "+p(v.text),1)]))),128))])]))),128))],512),s.value?(l(),u("div",{key:0,ref:"message",class:"error-message"},p(s.value),513)):g("",!0),c("button",{class:"submit",type:"button",onClick:i},"送出")],512),n.value?(l(),u("div",j,[a[0]||(a[0]=c("h2",{class:"result-header"},"測驗結果",-1)),F(f.$slots,"result",{result:n.value},()=>[typeof n.value=="string"?(l(),u("p",Q,p(n.value),1)):n.value&&"html"in n.value?(l(),u("p",{key:1,innerHTML:n.value.html},null,8,V)):n.value&&"text"in n.value?(l(),u("p",{key:2,textContent:p(n.value.text)},null,8,B)):g("",!0)])],512)):g("",!0)],64))}}),J=S(L,[["__scopeId","data-v-12e189df"]]);function $(t,e){typeof e=="string"&&e[0]==="{"?e=JSON.parse(e):(e instanceof FormData||typeof e=="string")&&(e=Object.fromEntries(e));for(const[s,n]of Object.entries(e)){const r=t.elements.namedItem(s);r.type==="checkbox"?r.checked=!!n:r.value=n}}function G(t="form"){const e=typeof t=="string"?document.querySelector(t):t,s=o=>o[Math.floor(Math.random()*o.length)],r=Array.from(e.elements).reduce((o,i)=>(i.name&&(o[i.name]??=[]).push(i.value),o),{});$(e,Object.fromEntries(Object.entries(r).map(([o,i])=>[o,s(i)])))}export{J as Q,G as a,I as b,b as g};
