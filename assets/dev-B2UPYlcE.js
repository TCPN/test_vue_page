import{d as z,k as h,u as y,c as r,o as l,a as c,l as g,F as q,r as _,t as p,m as b,n as F,j as w,g as A,_ as O}from"./Footer-XsVXUgjm.js";function k(t,e){const s=t.questions[e];return s?s.options??t.defaultOptions??[]:[]}function C(t=null){if(!t)return null;const e=new FormData(t);return Array.from(e.entries())}function N(t,e){return!t||t.length<e.questions.length?"尚有題目未作答":null}function R(t,e){let s=0;for(let[n,u]of t??[]){const o=e.questions.find(a=>a.index===Number(n));if(o?.scores){s+=o.scores[u]??0;continue}const f=k(e,Number(n)).find(a=>a.value===u);if(f){s+=f.score??0;continue}}return s}function S(t,e){const s=R(t,e);return{score:s,text:`你的總分是 ${s} 分`}}const j={ref:"questions",class:"questions"},D={class:"question-text"},E={class:"question-options"},M=["name","value"],T={key:0,ref:"result",class:"result"},Q={key:0},V=["innerHTML"],B=["textContent"],L=z({__name:"QuizForm",props:{quiz:{}},setup(t){const e=t,s=h(null),n=h(null),u=y("quizForm"),o=y("result");function i(){const f=e.quiz.getAnswers??C,a=e.quiz.validateAnswers??N,d=e.quiz.getResult??S,m=f(u.value),v=a(m,e.quiz);if(v){s.value=v;return}s.value=null,n.value=d(m,e.quiz)??null,console.log("quizResult",m,n.value),F(()=>{o.value?.scrollIntoView({behavior:"smooth"})})}return(f,a)=>(l(),r(q,null,[c("form",{ref_key:"quizForm",ref:u,class:"no-select"},[c("ol",j,[(l(!0),r(q,null,_(t.quiz.questions,(d,m)=>(l(),r("li",{key:m,class:"question"},[c("div",D,p(d.text),1),c("div",E,[(l(!0),r(q,null,_(w(k)(t.quiz,m),(v,x)=>(l(),r("label",{key:x,class:"question-option"},[c("input",{type:"radio",name:`${d.index}`,value:v.value},null,8,M),A(" "+p(v.text),1)]))),128))])]))),128))],512),s.value?(l(),r("div",{key:0,ref:"message",class:"error-message"},p(s.value),513)):g("",!0),c("button",{class:"submit",type:"button",onClick:i},"送出")],512),n.value?(l(),r("div",T,[a[0]||(a[0]=c("h2",{class:"result-header"},"測驗結果",-1)),b(f.$slots,"result",{result:n.value},()=>[typeof n.value=="string"?(l(),r("p",Q,p(n.value),1)):n.value&&"html"in n.value?(l(),r("p",{key:1,innerHTML:n.value.html},null,8,V)):n.value&&"text"in n.value?(l(),r("p",{key:2,textContent:p(n.value.text)},null,8,B)):g("",!0)])],512)):g("",!0)],64))}}),I=O(L,[["__scopeId","data-v-12e189df"]]);function $(t,e){typeof e=="string"&&e[0]==="{"?e=JSON.parse(e):(e instanceof FormData||typeof e=="string")&&(e=Object.fromEntries(e));for(const[s,n]of Object.entries(e)){const u=t.elements.namedItem(s);u.type==="checkbox"?u.checked=!!n:u.value=n}}function J(t="form"){const e=typeof t=="string"?document.querySelector(t):t,s=o=>o[Math.floor(Math.random()*o.length)],u=Array.from(e.elements).reduce((o,i)=>(i.name&&(o[i.name]??=[]).push(i.value),o),{});$(e,Object.fromEntries(Object.entries(u).map(([o,i])=>[o,s(i)])))}export{I as Q,J as a,R as g};
